---
// Astro 페이지 컴포넌트
import '@/styles/main.scss';
---

<html lang="ko">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="generator" content={Astro.generator} />
		<title>Image Generator - 이미지 변환 및 최적화</title>
	</head>
	<body>
		<div class="container">
			<header class="header">
				<h1>🖼️ Image Generator</h1>
				<p>이미지 변환, 크롭, 최적화를 한 번에!</p>
			</header>

			<main class="main-content">
								<div class="upload-section" id="uploadSection">
					<div class="upload-icon">📁</div>
					<div class="upload-text">이미지를 선택하거나 드래그하여 업로드하세요</div>
					<div class="upload-hint">JPG, PNG, GIF 파일을 지원합니다</div>
					<input type="file" id="fileInput" class="file-input" accept="image/*" />
				</div>

				<!-- 업로드 섹션 작업물 관리 버튼 -->
				<div class="upload-work-actions">
					<button class="btn btn-info" id="uploadLoadWorkBtn" title="저장된 작업물을 불러옵니다">📂 저장된 작업물 불러오기</button>
					<button class="btn btn-warning" id="uploadAutoSaveBtn" title="자동 저장을 토글합니다">🔄 자동저장</button>
				</div>

				<div class="preview-section" id="previewSection">
					<div class="preview-container">
						<div class="preview-box">
							<h3>원본 이미지</h3>
							<div class="preview-image-container">
								<img id="originalImage" class="preview-image" alt="원본 이미지" />
							</div>
							<div class="image-info" id="originalImageInfo">
								<div class="info-item">
									<span class="info-label">파일 크기:</span>
									<span class="info-value" id="originalFileSize">-</span>
								</div>
								<div class="info-item">
									<span class="info-label">이미지 크기:</span>
									<span class="info-value" id="originalImageSize">-</span>
								</div>
								<div class="info-item">
									<span class="info-label">형식:</span>
									<span class="info-value" id="originalFormat">-</span>
								</div>
							</div>
						</div>

						<div class="preview-box">
							<h3>처리된 이미지</h3>
							<div class="preview-image-container">
								<img id="processedImage" class="preview-image" alt="처리된 이미지" />
							</div>
							<div class="image-info" id="processedImageInfo">
								<div class="info-item">
									<span class="info-label">파일 크기:</span>
									<span class="info-value" id="processedFileSize">-</span>
								</div>
								<div class="info-item">
									<span class="info-label">이미지 크기:</span>
									<span class="info-value" id="processedImageSize">-</span>
								</div>
								<div class="info-item">
									<span class="info-label">형식:</span>
									<span class="info-value" id="processedFormat">-</span>
								</div>
								<div class="info-item compression-info" id="compressionInfo" style="display: none;">
									<span class="info-label">압축률:</span>
									<span class="info-value" id="compressionRatio">-</span>
								</div>
							</div>
						</div>
					</div>

					<!-- 확대/축소 컨트롤을 위로 이동 -->
					<div class="zoom-controls">
						<button class="zoom-btn" id="zoomOutBtn" title="축소">−</button>
						<span class="zoom-level" id="zoomLevel">100%</span>
						<button class="zoom-btn" id="zoomInBtn" title="확대">+</button>
						<button class="zoom-btn" id="resetZoomBtn" title="원본 크기">⟲</button>
					</div>

					<div class="controls-section">
						<div class="controls-grid">
							<div class="control-group">
								<label for="formatSelect">출력 형식</label>
								<select id="formatSelect">
									<option value="original">원본 형식 유지</option>
									<option value="jpeg">JPEG</option>
									<option value="png">PNG</option>
									<option value="webp">WebP</option>
								</select>
							</div>

							<!-- JPEG 품질 설정 -->
							<div class="control-group" id="jpegQualityGroup">
								<label for="jpegQualitySlider">JPEG 품질 (1-100)</label>
								<input type="range" id="jpegQualitySlider" min="1" max="100" value="80" />
								<span id="jpegQualityValue">80%</span>
							</div>

							<!-- PNG 압축 설정 -->
							<div class="control-group" id="pngCompressionGroup" style="display: none;">
								<label for="pngCompressionSlider">PNG 압축 레벨 (0-9)</label>
								<input type="range" id="pngCompressionSlider" min="0" max="9" value="6" />
								<span id="pngCompressionValue">6</span>
								<small>0-3: 원본 크기, 4-6: 약간 축소, 7-9: 크게 축소</small>
							</div>

							<!-- WebP 품질 설정 -->
							<div class="control-group" id="webpQualityGroup" style="display: none;">
								<label for="webpQualitySlider">WebP 품질 (1-100)</label>
								<input type="range" id="webpQualitySlider" min="1" max="100" value="80" />
								<span id="webpQualityValue">80%</span>
								<div class="checkbox-group">
									<input type="checkbox" id="webpTransparency" />
									<label for="webpTransparency">투명도 지원</label>
								</div>
							</div>

							<div class="control-group">
								<label for="maxWidth">최대 너비 (px)</label>
								<input type="number" id="maxWidth" placeholder="자동" />
							</div>
							<div class="control-group">
								<label for="maxHeight">최대 높이 (px)</label>
								<input type="number" id="maxHeight" placeholder="자동" />
							</div>
						</div>

						<div class="action-buttons">
							<button class="btn btn-primary" id="processBtn" title="업로드된 이미지를 선택한 설정으로 처리합니다">이미지 처리</button>
							<button class="btn btn-secondary" id="cropBtn" title="이미지의 특정 영역을 선택하여 크롭합니다">크롭 모드</button>
							<button class="btn btn-success" id="downloadBtn" title="처리된 이미지를 다운로드합니다">다운로드</button>
							<button class="btn btn-warning" id="resetImageBtn" title="업로드된 이미지를 초기화하고 새 이미지를 업로드할 수 있습니다">이미지 초기화</button>
							<button class="btn btn-secondary" id="resetBtn" title="모든 설정을 초기화하고 처음부터 다시 시작합니다">새로 시작</button>
						</div>

						<div class="work-actions">
							<button class="btn btn-info" id="saveWorkBtn" title="현재 작업물을 저장합니다">작업물 저장</button>
							<button class="btn btn-info" id="loadWorkBtn" title="저장된 작업물 목록을 불러옵니다">작업물 불러오기</button>
							<button class="btn btn-warning" id="autoSaveBtn" title="자동 저장을 토글합니다">자동저장</button>
							<button class="btn btn-danger" id="clearWorksBtn" title="모든 저장된 작업물을 삭제합니다">작업물 삭제</button>
						</div>

						<!-- 사이즈 별 저장 옵션 -->
						<div class="size-options" id="sizeOptions" style="display: none;">
							<h4>저장 크기 선택</h4>
							<div class="size-checkboxes">
								<div class="size-option">
									<input type="checkbox" id="size1x" value="1" checked />
									<label for="size1x">@x1 (원본 크기)</label>
								</div>
								<div class="size-option">
									<input type="checkbox" id="size2x" value="2" />
									<label for="size2x">@x2 (2배 크기)</label>
								</div>
								<div class="size-option">
									<input type="checkbox" id="size3x" value="3" />
									<label for="size3x">@x3 (3배 크기)</label>
								</div>
							</div>
							<button class="btn btn-primary" id="downloadMultiBtn">선택한 크기로 다운로드</button>
						</div>
					</div>

					<div class="crop-section" id="cropSection">
						<h3>이미지 크롭</h3>
						<p>드래그하여 크롭 영역을 선택하세요</p>
						<div class="crop-container">
							<img id="cropImage" class="crop-image" alt="크롭할 이미지" />
							<div class="crop-overlay" id="cropOverlay">
								<!-- 모서리 핸들 -->
								<div class="crop-handle nw" id="cropHandleNW"></div>
								<div class="crop-handle n" id="cropHandleN"></div>
								<div class="crop-handle ne" id="cropHandleNE"></div>
								<div class="crop-handle w" id="cropHandleW"></div>
								<div class="crop-handle e" id="cropHandleE"></div>
								<div class="crop-handle sw" id="cropHandleSW"></div>
								<div class="crop-handle s" id="cropHandleS"></div>
								<div class="crop-handle se" id="cropHandleSE"></div>
							</div>
						</div>
						<div class="action-buttons">
							<button class="btn btn-success" id="applyCropBtn">크롭 적용</button>
							<button class="btn btn-secondary" id="cancelCropBtn">취소</button>
						</div>
					</div>
				</div>
			</main>
		</div>

		<!-- 프라이버시 안내 섹션 -->
		<footer class="privacy-footer">
			<div class="privacy-content">
				<div class="privacy-info">
					<h4>🔒 개인정보 보호 안내</h4>
					<p>이 애플리케이션은 <strong>완전히 클라이언트 사이드</strong>에서 동작합니다.</p>
					<ul>
						<li>✅ <strong>모든 데이터는 사용자의 브라우저에만 저장</strong>됩니다</li>
						<li>✅ <strong>서버로 데이터가 전송되지 않습니다</strong></li>
						<li>✅ <strong>개인정보 수집 및 저장을 하지 않습니다</strong></li>
						<li>✅ <strong>이미지 처리는 사용자의 컴퓨터에서만 수행</strong>됩니다</li>
					</ul>
					<p class="privacy-note">작업물은 브라우저의 LocalStorage에 저장되며, 브라우저 데이터를 삭제하면 함께 삭제됩니다.</p>
				</div>
			</div>
		</footer>

		<!-- 작업물 목록 모달 -->
		<div class="work-modal" id="workModal">
			<div class="work-modal-content">
				<div class="work-modal-header">
					<h3>저장된 작업물</h3>
					<button class="close-btn" id="closeWorkModal">&times;</button>
				</div>
				<div class="work-modal-body">
					<div class="work-list" id="workList">
						<!-- 작업물 목록이 여기에 동적으로 추가됩니다 -->
					</div>
					<div class="work-empty" id="workEmpty" style="display: none;">
						<p>저장된 작업물이 없습니다.</p>
					</div>
				</div>
			</div>
		</div>

		<!-- 작업물 저장 모달 -->
		<div class="work-save-modal" id="workSaveModal">
			<div class="work-save-modal-content">
				<div class="work-save-modal-header">
					<h3>작업물 저장</h3>
					<button class="close-btn" id="closeWorkSaveModal">&times;</button>
				</div>
				<div class="work-save-modal-body">
					<div class="form-group">
						<label for="workNameInput">작업물 이름</label>
						<input type="text" id="workNameInput" placeholder="작업물 이름을 입력하세요" />
					</div>
					<div class="work-save-preview">
						<h4>저장할 내용</h4>
						<div class="preview-item">
							<span class="preview-label">원본 이미지:</span>
							<span class="preview-value" id="saveOriginalPreview">-</span>
						</div>
						<div class="preview-item">
							<span class="preview-label">처리된 이미지:</span>
							<span class="preview-value" id="saveProcessedPreview">-</span>
						</div>
						<div class="preview-item">
							<span class="preview-label">설정:</span>
							<span class="preview-value" id="saveSettingsPreview">-</span>
						</div>
					</div>
					<div class="work-save-actions">
						<button class="btn btn-primary" id="confirmSaveWorkBtn">저장</button>
						<button class="btn btn-secondary" id="cancelSaveWorkBtn">취소</button>
					</div>
				</div>
			</div>
		</div>

		<script type="module" src={import.meta.env.BASE_URL + '/js/app.js'} client:load></script>
	</body>
</html>
